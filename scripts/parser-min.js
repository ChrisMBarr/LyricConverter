var TextCleaner=function(){function e(e){for(var t="",n=0;n<e.length;n++){for(var r=e.charCodeAt(n).toString(16).toUpperCase();r.length<4;)r="0"+r;r="\\u"+r,t+=r}return t}function t(t){return t.replace(o,function(t){var n=e(t);return a[n]||""})}for(var n=["\\u00E2\\u201A\\u00AC","\\u00C3\\u20AC","\\u00C3","\\u00E2\\u20AC\\u0161","\\u00C3\\u201A","\\u00C6\\u2019","\\u00C3\\u0192","\\u00E2\\u20AC\\u017E","\\u00C3\\u201E","\\u00E2\\u20AC\\u00A6","\\u00C3\\u2026","\\u00E2\\u20AC","\\u00C3\\u2020","\\u00E2\\u20AC\\u00A1","\\u00C3\\u2021","\\u00CB\\u2020","\\u00C3\\u02C6","\\u00E2\\u20AC\\u00B0","\\u00C3\\u2030","\\u00C5","\\u00C3\\u0160","\\u00E2\\u20AC\\u00B9","\\u00C3\\u2039","\\u00C5\\u2019","\\u00C3\\u0152","\\u00C3","\\u00C5\\u00BD","\\u00C3\\u017D","\\u00C3","\\u00C3","\\u00E2\\u20AC\\u02DC","\\u00C3\\u2018","\\u00E2\\u20AC\\u2122","\\u00C3\\u2019","\\u00E2\\u20AC\\u0153","\\u00C3\\u201C","\\u00E2\\u20AC","\\u00C3\\u201D","\\u00E2\\u20AC\\u00A2","\\u00C3\\u2022","\\u00E2\\u20AC\\u201C","\\u00C3\\u2013","\\u00E2\\u20AC\\u201D","\\u00C3\\u2014","\\u00CB\\u0153","\\u00C3\\u02DC","\\u00E2\\u201E\\u00A2","\\u00C3\\u2122","\\u00C5\\u00A1","\\u00C3\\u0161","\\u00E2\\u20AC\\u00BA","\\u00C3\\u203A","\\u00C5\\u201C","\\u00C3\\u0153","\\u00C3","\\u00C5\\u00BE","\\u00C3\\u017E","\\u00C5\\u00B8","\\u00C3\\u0178","\\u00C3","\\u00C2\\u00A1","\\u00C3\\u00A1","\\u00C2\\u00A2","\\u00C3\\u00A2","\\u00C2\\u00A3","\\u00C3\\u00A3","\\u00C2\\u00A4","\\u00C3\\u00A4","\\u00C2\\u00A5","\\u00C3\\u00A5","\\u00C2\\u00A6","\\u00C3\\u00A6","\\u00C2\\u00A7","\\u00C3\\u00A7","\\u00C2\\u00A8","\\u00C3\\u00A8","\\u00C2\\u00A9","\\u00C3\\u00A9","\\u00C2\\u00AA","\\u00C3\\u00AA","\\u00C2\\u00AB","\\u00C3\\u00AB","\\u00C2\\u00AC","\\u00C3\\u00AC","\\u00C2\\u00AD","\\u00C3\\u00AD","\\u00C2\\u00AE","\\u00C3\\u00AE","\\u00C2\\u00AF","\\u00C3\\u00AF","\\u00C2\\u00B0","\\u00C3\\u00B0","\\u00C2\\u00B1","\\u00C3\\u00B1","\\u00C2\\u00B2","\\u00C3\\u00B2","\\u00C2\\u00B3","\\u00C3\\u00B3","\\u00C2\\u00B4","\\u00C3\\u00B4","\\u00C2\\u00B5","\\u00C3\\u00B5","\\u00C2\\u00B6","\\u00C3\\u00B6","\\u00C2\\u00B7","\\u00C3\\u00B7","\\u00C2\\u00B8","\\u00C3\\u00B8","\\u00C2\\u00B9","\\u00C3\\u00B9","\\u00C2\\u00BA","\\u00C3\\u00BA","\\u00C2\\u00BB","\\u00C3\\u00BB","\\u00C2\\u00BC","\\u00C3\\u00BC","\\u00C2\\u00BD","\\u00C3\\u00BD","\\u00C2\\u00BE","\\u00C3\\u00BE","\\u00C2\\u00BF","\\u00C3\\u00BF"],r=["€","À","Á","‚","Â","ƒ","Ã","„","Ä","…","Å","†","Æ","‡","Ç","ˆ","È","‰","É","Š","Ê","‹","Ë","Œ","Ì","Í","Ž","Î","Ï","Ð","‘","Ñ","’","Ò","“","Ó","”","Ô","•","Õ","–","Ö","—","×","˜","Ø","™","Ù","š","Ú","›","Û","œ","Ü","Ý","ž","Þ","Ÿ","ß","à","¡","á","¢","â","£","ã","¤","ä","¥","å","¦","æ","§","ç","¨","è","©","é","ª","ê","«","ë","¬","ì","­","í","®","î","¯","ï","°","ð","±","ñ","²","ò","³","ó","´","ô","µ","õ","¶","ö","·","÷","¸","ø","¹","ù","º","ú","»","û","¼","ü","½","ý","¾","þ","¿","ÿ"],a={},i=0;i<n.length;i++)a[n[i]]=r[i];n.sort(function(e,t){return t.length-e.length});var o=new RegExp(n.join("|"),"g");return{ConvertWin1252ToUtf8:t}}();!function(){function e(e,t){for(var n=e.match(/{.+?:.+?}/gim),r=[],a=0;a<n.length;a++){var i=n[a].replace(/^{(.*)}/,"$1").split(":"),o={};o[$.trim(i[0])]=$.trim(i[1]),r.push(o)}return{title:r.title||r.Title||t.replace(".txt",""),info:r}}function t(e){for(var t=[],n=e.match(/(\w+(\s\d)*:[\r\n]+)+(.+[\n\r])+/gim),r=0;r<n.length;r++){var a=n[r].split(/[\r\n]+/g),i=$.trim(a.shift().replace(":","")),o=$.trim(a.join("\n").replace(/\[.+?\]|{.+?}/g,""));t.push({title:i,lyrics:o})}return t}var n="chordpro";parser.formats[n]={},parser.formats[n].testFormat=function(e,t){return/txt/i.test(e)&&/^{.+:\s*.*}[\r\n]+/i.test(t)},parser.formats[n].convert=function(n,r){var a=e(n,r),i=t(n),o={title:a.title,info:a.info,slides:i};return console.log(o),o}}(),function(){function e(e){var t=[];return e.each(function(e,r){var a=$(r),i=$.trim(a.attr("label")),o=a.find("rvtextelement").attr("rtfdata"),u=parser.utilities.decode(o),l=n(u);t.push({title:i,lyrics:l})}),t}function t(e){var t=["height","width","cclisongtitle","cclidisplay","versionnumber","doctype","creatorcode","lastdateused","usedcount","backgroundcolor","drawingbackgroundcolor"],n=[];$.each(e,function(e,r){$.inArray(r.name,t)<0&&""!==r.value&&n.push({name:r.name,value:r.value})});var r=new Date(Date.parse(e.lastdateused.value));return isNaN(r.getTime())||n.push({name:"Last Used On",value:r}),n}function n(e){var t=/\{\*?\\[^{}]+}|[{}]|\\[A-Za-z]+\n?(?:-?\d+)?[ ]?/g,n=/\\\n/g,r=e.replace(t,""),a=r.replace(n,"\n"),i=a.trim();return i}var r="pro4";parser.formats[r]={},parser.formats[r].testFormat=function(e){return/pro\d+/i.test(e)},parser.formats[r].convert=function(n,r){var a=$(n),i=a.get(0).attributes,o=a.children("slides").children(),u="string"==typeof i.cclisongtitle&&i.cclisongtitle.length>0?i.cclisongtitle.value:r;return{title:u,info:t(i),slides:e(o)}}}(),function(){function e(e,t,n){var r=e.split(i);r=$.grep(r,function(e){var t=$.trim(e).replace(/\r\n\t/g,"");return t.length>1?t:!1}),/[0-9]{1,4}/.test(r[0])&&r.splice(0,1);var a=r.length>0&&r[0].length>0?r[0]:n;a=1===a.indexOf("$")?a.substring(1,a.length):a,a=a.substring(0,a.length-+(a.lastIndexOf("$")==a.length-1));var o=[];r[1]&&o.push({name:"Artist/Author",value:r[1]}),r[2]&&o.push({name:"Copyright",value:r[2].replace("$","")}),r[3]&&o.push({name:"CCLI",value:r[3]}),t&&o.push({name:"Keywords",value:t}),a=TextCleaner.ConvertWin1252ToUtf8(a);for(var u=0;u<o.length;u++)o[u].value=TextCleaner.ConvertWin1252ToUtf8(o[u].value);return{info:o,title:a}}function t(e){for(var t=new RegExp("^"+a+"+.{1}"+a+"+(.+)"+a+"+\\W*([\\s\\S]+)","m"),r=[],o=1;o<e.length;o++){var u=e[o].match(t),l=null!==u&&u[1]?$.trim(u[1].replace(i,"")):"",s=null!==u&&u[2]?$.trim(u[2].replace(i,"")):"";l=TextCleaner.ConvertWin1252ToUtf8(l),s=TextCleaner.ConvertWin1252ToUtf8(s),s=s.replace(/\/+/g,""),r.push({title:l,lyrics:s})}var c=n(e.slice(-1)[0]),d=!1;return c&&(0===r.length&&c.keywords.length>c.lastLyrics.length?(d=c.lastLyrics,r.push({title:"",lyrics:c.keywords.replace(/\/+/g,"")})):(d=c.keywords,r.length>0?r.slice(-1)[0].lyrics=c.lastLyrics:r.push({title:"",lyrics:c.lastLyrics.replace(/\/+/g,"")}))),{slides:r,keywords:d}}function n(e){var t=e.split(i);if(t=$.grep(t,function(e){var t=$.trim(e);return t.length>1?t:!1}),t.length>2){var n=t.splice(2).join(", ").replace(/\r\n\t/g,""),r=t[1].match(/^\W*([\s\S]+)/m)[1];return n=TextCleaner.ConvertWin1252ToUtf8(n),r=TextCleaner.ConvertWin1252ToUtf8(r),{keywords:n,lastLyrics:r}}return!1}var r="songshowplus";parser.formats[r]={},parser.formats[r].testFormat=function(e){return/sbsong/i.test(e)},parser.formats[r].convert=function(n,r){var a=n.split("<Properties>")[0].split("%"),i=t(a),o=e(a[0],i.keywords,r);return{title:o.title,info:o.info,slides:i.slides}};var a="[\\xA0\\x00-\\x09\\x0B\\x0C\\x0E-\\x1F\\x7F]",i=new RegExp(a,"g")}(),function(){function e(e){var t='<h3 class="song-title">'+e.title+"</h3>";t+='<ul class="song-info">';for(var n=0;n<e.info.length;n++){var r=e.info[n];t+="<li><strong>"+r.name+":</strong> "+r.value+"</li>"}t+='</ul><ul class="slides-container thumbnails">';for(var n=0;n<e.slides.length;n++){var r=e.slides[n],a=r.title.length<1?"&nbsp;":r.title;t+='<li class="span3"><div class="thumbnail slide-content"><p class="slide-lyrics">'+r.lyrics+'</p><h6 class="slide-label">'+a+"</h6></div></li>"}return t+="</ul>"}function t(e){var t=0;e.find(".slide-lyrics").each(function(e){$(this).height()>t&&(t=$(this).height())}).css({"min-height":t})}var n="display";parser.outputs[n]=function(n,r){$.each(r,function(r,a){var i=$(e(a.data));n.append(i),t(i)})}}(),function(){function e(e){for(var n=t(e),r=0;r<e.slides.length;r++){var i=e.slides[r];n+=a(r,i.title,i.lyrics)}return n+='</slides><timeline timeOffSet="0" selectedMediaTrackIndex="0" unitOfMeasure="60" duration="0" loop="0"><timeCues containerClass="NSMutableArray"></timeCues><mediaTracks containerClass="NSMutableArray"></mediaTracks></timeline><bibleReference containerClass="NSMutableDictionary"></bibleReference></RVPresentationDocument>'}function t(e){for(var t="",n="",r="",a="",i="",o="",u=new Date,l=u.getFullYear()+"-"+u.getMonth()+"-"+u.getDate()+"T"+u.getHours()+":"+u.getMinutes()+":"+u.getSeconds(),s=0;s<e.info.length;s++){var c=e.info[s];if(/copyright/i.test(c.name)){var d=c.value.match(/(\d{4})(.*)/);d?(d.length>1&&(a=d[1]),d.length>2&&(i=d[2])):i=c.value}else/ccli/i.test(c.name)?o=c.value:/keywords/i.test(c.name)?t=c.value:/author|artist/i.test(c.name)&&(n=c.value,r=c.value)}return'<RVPresentationDocument height="768" width="1024" versionNumber="400" docType="0" creatorCode="1349676880" lastDateUsed="'+l+'" usedCount="0" category="Song" resourcesDirectory="" backgroundColor="0 0 0 1" drawingBackgroundColor="0" notes="'+t+'" artist="'+n+'" author="'+r+'" album="" CCLIDisplay="0" CCLIArtistCredits="" CCLISongTitle="'+e.title+'" CCLIPublisher="'+i+'" CCLICopyrightInfo="'+a+'" CCLILicenseNumber="'+o+'"><slides containerClass="NSMutableArray">'}function n(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}function r(e){return'<RVDisplaySlide backgroundColor="0 0 0 0" enabled="1" highlightColor="0 0 0 0" hotKey="" label="" notes="" slideType="1" sort_index="'+e+'" UUID="'+n()+'" drawingBackgroundColor="0" serialization-array-index="'+e+'"><cues containerClass="NSMutableArray"></cues><displayElements containerClass="NSMutableArray"></displayElements></RVDisplaySlide>'}function a(e,t,r){var a=["{\\rtf1\\ansi\\ansicpg1252\\cocoartf1038\\cocoasubrtf320","{\\fonttbl\\f0\\fswiss\\fcharset0 Helvetica;}","{\\colortbl;\\red255\\green255\\blue255;}","\\pard\\tx560\\tx1120\\tx1680\\tx2240\\tx2800\\tx3360\\tx3920\\tx4480\\tx5040\\tx5600\\tx6160\\tx6720\\qc\\pardirnatural","","\\f0\\fs96 \\cf1 "+r.replace(/\r\n/g,"\\\n")+"}"].join("\n"),i=parser.utilities.encode(a),o=["",'<RVDisplaySlide backgroundColor="0 0 0 0" enabled="1" highlightColor="0 0 0 0" hotKey="" label="'+t+'" notes="" slideType="1" sort_index="'+e+'" UUID="'+n()+'" drawingBackgroundColor="0" serialization-array-index="'+e+'">','	<cues containerClass="NSMutableArray"></cues>','	<displayElements containerClass="NSMutableArray">','		<RVTextElement displayDelay="0" displayName="Default" locked="0" persistent="0" typeID="0" fromTemplate="0" bezelRadius="0" drawingFill="0" drawingShadow="0" drawingStroke="0" fillColor="1 1 1 1" rotation="0" source="" adjustsHeightToFit="0" verticalAlignment="0" RTFData="'+i+'" serialization-array-index="0">','			<_-RVRect3D-_position x="20" y="20" z="0" width="984" height="728"></_-RVRect3D-_position>','			<_-D-_serializedShadow containerClass="NSMutableDictionary">','				<NSCFNumber serialization-native-value="5" serialization-dictionary-key="shadowBlurRadius"></NSCFNumber>','				<NSCalibratedRGBColor serialization-native-value="0 0 0 0.5" serialization-dictionary-key="shadowColor"></NSCalibratedRGBColor>','				<NSCFString serialization-native-value="{3.53553, -3.53553}" serialization-dictionary-key="shadowOffset"></NSCFString>',"			</_-D-_serializedShadow>",'			<stroke containerClass="NSMutableDictionary">','				<NSCachedRGBColor serialization-native-value="0 0 0 1" serialization-dictionary-key="RVShapeElementStrokeColorKey"></NSCachedRGBColor>','				<NSCFNumber serialization-native-value="1" serialization-dictionary-key="RVShapeElementStrokeWidthKey"></NSCFNumber>',"			</stroke>","		</RVTextElement>","	</displayElements>","</RVDisplaySlide>"].join("\n");return o}function i(e,t){if(t.length>0){var n="btn-"+o+"-download-zip",r="btn-"+o+"-download-files",a="<h1>Converted "+t.length+" Song File"+(t.length>1?"s":"")+"!</h1>";t.length>1?(a+="<button id='"+n+"' type='button' class='btn btn-large btn-primary'>Download as .zip</button>",a+=" or <button id='"+r+"' type='button' class='btn'>Download "+t.length+" individual files</button>"):a+="<button id='"+r+"' type='button' class='btn btn-large btn-primary'>Download file</button>",e.html(a),$("#"+n).on("click",function(){var e=new JSZip;$.each(t,function(t,n){e.file(n.name+u,n.data)});var n=e.generate({type:"blob"});saveAs(n,"converted files.zip")}),$("#"+r).on("click",function(){$.each(t,function(e,t){var n=new Blob([t.data],{type:"text/xml;charset=utf-8"});saveAs(n,t.name+u)})})}}var o="pro4",u=".pro4";parser.outputs[o]=function(t,n){var r=[],a=[];$.each(n,function(t,n){try{r.push({name:n.name,data:e(n.data)})}catch(i){a.push(n.name)}}),a.length&&parser.displayError(a.join(", "),"Error converting the following "+a.length+" songs!"),i(t,r)}}(),function(){function e(e){var n=t(e);n+=r(0);for(var i=0;i<e.slides.length;i++){var o=e.slides[i];n+=a(i+1,o.title,o.lyrics)}return n+=r(e.slides.length+1),n+=["","   </groups>",'   <timeline timeOffSet="0" selectedMediaTrackIndex="0" unitOfMeasure="60" duration="0" loop="0">','      <timeCues containerClass="NSMutableArray" />','      <mediaTracks containerClass="NSMutableArray" />',"   </timeline>",'   <bibleReference containerClass="NSMutableDictionary" />','   <arrangements containerClass="NSMutableArray" />',"</RVPresentationDocument>"].join("\n")}function t(e){for(var t="",n="",r="",a="",i="",o="",u=new Date,l=u.getFullYear()+"-"+u.getMonth()+"-"+u.getDate()+"T"+u.getHours()+":"+u.getMinutes()+":"+u.getSeconds(),s=0;s<e.info.length;s++){var c=e.info[s];if(/copyright/i.test(c.name)){var d=c.value.match(/(\d{4})(.*)/);d?(d.length>1&&(a=d[1]),d.length>2&&(i=d[2])):i=c.value}else/ccli/i.test(c.name)?o=c.value:/keywords/i.test(c.name)?t=c.value:/author|artist/i.test(c.name)&&(n=c.value,r=c.value)}return['<?xml version="1.0" encoding="UTF-8"?>','<RVPresentationDocument height="768" width="1024" versionNumber="500" docType="0" creatorCode="1349676880" lastDateUsed="'+l+'" usedCount="0" category="Song" resourcesDirectory="" backgroundColor="0 0 0 1" drawingBackgroundColor="0" notes="'+t+'" artist="'+n+'" author="'+r+'" album="" CCLIDisplay="0" CCLIArtistCredits="" CCLISongTitle="'+e.title+'" CCLIPublisher="'+i+'" CCLICopyrightInfo="'+a+'" CCLILicenseNumber="'+o+'" chordChartPath="">',"",'    <_-RVProTransitionObject-_transitionObject transitionType="-1" transitionDuration="1" motionEnabled="0" motionDuration="20" motionSpeed="100" />','    <groups containerClass="NSMutableArray">'].join("\n")}function n(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}function r(e){return["",'<RVSlideGrouping name="" uuid="'+n()+'" color="0 0 0 0" serialization-array-index="'+e+'">','    <slides containerClass="NSMutableArray">','        <RVDisplaySlide backgroundColor="0 0 0 0" enabled="1" highlightColor="" hotKey="" label="" notes="" slideType="1" sort_index="0" UUID="'+n()+'" drawingBackgroundColor="0" chordChartPath="" serialization-array-index="0">','            <cues containerClass="NSMutableArray" />','            <displayElements containerClass="NSMutableArray" />','            <_-RVProTransitionObject-_transitionObject transitionType="-1" transitionDuration="1" motionEnabled="0" motionDuration="20" motionSpeed="100" />',"        </RVDisplaySlide>","    </slides>","</RVSlideGrouping>"].join("\n")}function a(e,t,r){var a=["{\\rtf1\\ansi\\ansicpg1252\\cocoartf1038\\cocoasubrtf320","{\\fonttbl\\f0\\fswiss\\fcharset0 Helvetica;}","{\\colortbl;\\red255\\green255\\blue255;}","\\pard\\tx560\\tx1120\\tx1680\\tx2240\\tx2800\\tx3360\\tx3920\\tx4480\\tx5040\\tx5600\\tx6160\\tx6720\\qc\\pardirnatural","","\\f0\\fs96 \\cf1 "+r.replace(/\r\n/g,"\\\n")+"}"].join("\n"),i=parser.utilities.encode(a),o=["",'<RVSlideGrouping name="'+t+'" uuid="'+n()+'" color="0 0 0 0" serialization-array-index="'+e+'">','    <slides containerClass="NSMutableArray">','        <RVDisplaySlide backgroundColor="0 0 0 0" enabled="1" highlightColor="" hotKey="" label="" notes="" slideType="1" sort_index="'+e+'" UUID="'+n()+'" drawingBackgroundColor="0" chordChartPath="" serialization-array-index="0">','            <cues containerClass="NSMutableArray" />','            <displayElements containerClass="NSMutableArray">','                <RVTextElement displayDelay="0" displayName="Default" locked="0" persistent="0" typeID="0" fromTemplate="0" bezelRadius="0" drawingFill="0" drawingShadow="0" drawingStroke="0" fillColor="1 1 1 1" rotation="0" source="" adjustsHeightToFit="0" verticalAlignment="0" RTFData="'+i+'" revealType="0" serialization-array-index="0">','                    <_-RVRect3D-_position x="20" y="20" z="0" width="984" height="728" />','                    <_-D-_serializedShadow containerClass="NSMutableDictionary">','                        <NSMutableString serialization-native-value="{3.5355301, -3.5355301}" serialization-dictionary-key="shadowOffset" />','                        <NSNumber serialization-native-value="5" serialization-dictionary-key="shadowBlurRadius" />','                        <NSColor serialization-native-value="0 0 0 0.5" serialization-dictionary-key="shadowColor" />',"                    </_-D-_serializedShadow>",'                    <stroke containerClass="NSMutableDictionary">','                        <NSColor serialization-native-value="0 0 0 1" serialization-dictionary-key="RVShapeElementStrokeColorKey" />','                        <NSNumber serialization-native-value="1" serialization-dictionary-key="RVShapeElementStrokeWidthKey" />',"                    </stroke>","                </RVTextElement>","            </displayElements>",'            <_-RVProTransitionObject-_transitionObject transitionType="-1" transitionDuration="1" motionEnabled="0" motionDuration="20" motionSpeed="100" />',"        </RVDisplaySlide>","    </slides>","</RVSlideGrouping>"].join("\n");return o}function i(e,t){if(t.length>0){var n="btn-"+o+"-download-zip",r="btn-"+o+"-download-files",a="<h1>Converted "+t.length+" Song File"+(t.length>1?"s":"")+"!</h1>";t.length>1?(a+="<button id='"+n+"' type='button' class='btn btn-large btn-primary'>Download as .zip</button>",a+=" or <button id='"+r+"' type='button' class='btn'>Download "+t.length+" individual files</button>"):a+="<button id='"+r+"' type='button' class='btn btn-large btn-primary'>Download file</button>",e.html(a),$("#"+n).on("click",function(){var e=new JSZip;$.each(t,function(t,n){e.file(n.name+u,n.data)});var n=e.generate({type:"blob"});saveAs(n,"converted files.zip")}),$("#"+r).on("click",function(){$.each(t,function(e,t){var n=new Blob([t.data],{type:"text/xml;charset=utf-8"});saveAs(n,t.name+u)})})}}var o="pro5",u=".pro5";parser.outputs[o]=function(t,n){var r=[],a=[];$.each(n,function(t,n){try{r.push({name:n.name,data:e(n.data)})}catch(i){a.push(n.name)}}),a.length&&parser.displayError(a.join(", "),"Error converting the following "+a.length+" songs!"),i(t,r)}}(),function(){function e(e){for(var t="Title: "+e.title,n=0;n<e.info.length;n++){var r=e.info[n];r.name&&r.value&&(t+="\r\n",t+=r.name+": "+r.value)}t+="\r\n\r\n";for(var n=0;n<e.slides.length;n++){var a=e.slides[n];(a.title.length>0||a.lyrics.length>0)&&(t+=a.title,t+="\r\n",t+=a.lyrics,n<e.slides.length-1&&(t+="\r\n\r\n"))}return t}function t(e,t){if(t.length>0){var a="btn-"+n+"-download-zip",i="btn-"+n+"-download-files",o="<h1>Converted "+t.length+" Song File"+(t.length>1?"s":"")+"!</h1>";t.length>1?(o+="<button id='"+a+"' type='button' class='btn btn-large btn-primary'>Download as .zip</button>",o+=" or <button id='"+i+"' type='button' class='btn'>Download "+t.length+" individual files</button>"):o+="<button id='"+i+"' type='button' class='btn btn-large btn-primary'>Download file</button>",e.html(o),$("#"+a).on("click",function(){var e=new JSZip;$.each(t,function(t,n){e.file(n.name+r,n.data)});var n=e.generate({type:"blob"});saveAs(n,"converted files.zip")}),$("#"+i).on("click",function(){$.each(t,function(e,t){var n=new Blob([t.data],{type:"text/xml;charset=utf-8"});saveAs(n,t.name+r)})})}}var n="text",r=".txt";parser.outputs[n]=function(n,r){var a=[],i=[];$.each(r,function(t,n){try{a.push({name:n.name,data:e(n.data)})}catch(r){i.push(n.name)}}),i.length&&parser.displayError(i.join(", "),"Error converting the following "+i.length+" songs!"),t(n,a)}}();var parser=function(){function e(e,t){var r=t.data,a=t.name;try{var i=a.split("."),o=i.slice(-1)[0].toLowerCase(),u=a.replace("."+o,""),l=r.replace(/^data:.*;base64,/,""),s=n.decode(l),c;$.each(parser.formats,function(e,t){return t.testFormat(o,s)?(c=t.convert,!1):void 0}),$.isFunction(c)?parser.songList.push({name:u,data:c(s,u)}):parser.errorList.push("The file <strong>"+a+"</strong> cannot be parsed because <strong>."+o.toUpperCase()+"</strong> files are not supported!")}catch(d){console.error(d),parser.errorList.push("There was an error reading the file <strong>"+a+"</strong>")}}function t(e){parser.songList.length&&parser.outputs[parser.outputFormat](e,parser.songList)}var n={decode:function(e){var t=window.atob(e);try{return decodeURIComponent(escape(t))}catch(n){return t}},encode:function(e){return window.btoa(unescape(encodeURIComponent(e)))}};return{utilities:n,parseFile:e,complete:t,outputFormat:null,displayError:null,songList:[],errorList:[],formats:{},outputs:{}}}();