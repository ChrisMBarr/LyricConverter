var parser=function(){function o(r){e.text(r.title);r.slides.length>0&&n.show();for(var i=0;i<r.info.length;i++){var s=r.info[i];$("<li><strong>"+s.name+":</strong> "+s.value+"</li>").appendTo(t)}for(var i=0;i<r.slides.length;i++){var s=r.slides[i],o=s.title.length<1?"&nbsp;":s.title;$("<div class='slide'><div class='content'>"+s.lyrics+"</div><div class='label'>"+o+"</div></div>").appendTo(n)}}function u(){r.empty().hide();e.text("");t.empty();n.empty().hide()}function a(e){r.show().html(e)}var e,t,n,r,i={pageInit:function(){Modernizr.load({test:window.atob&&window.btoa,nope:"js/base64.js"});e=$("#song-title");t=$("#song-info");n=$("#song-slides");r=$("#error-display");Modernizr.draganddrop&&window.FileReader?i.fileDragAndDrop():a("Your browser does not support file Drag-N-Drop!")},fileDragAndDrop:function(){$("#drop-area").fileDragAndDrop(function(e,t){u();var n=t.split(".").slice(-1)[0].toLowerCase();if($.isFunction(parser.formats[n])){var r=e.replace(/^data:.*;base64,/,""),f=s.decode(r),l=parser.formats[n](f);o(l);i.equalSlideHeights()}else a("The file <strong>"+t+"</strong> cannot be parsed because <strong>."+n.toUpperCase()+"</strong> is not a supported file type!")})},equalSlideHeights:function(){var e=0,t=$("#song-slides").children().children(".content");t.each(function(t){$(this).height()>e&&(e=$(this).height())});t.css({"min-height":e})}},s={decode:function(e){var t=window.atob(e);try{return decodeURIComponent(escape(t))}catch(n){return t}},encode:function(e){return window.btoa(unescape(encodeURIComponent(e)))}};$(i.pageInit);return{utilities:s,displayError:a,formats:{}}}();